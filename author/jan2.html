<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>visibilityspots - Jan</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/normalize.css">
        <link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/main.css">
	<link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/tipuesearch/tipuesearch.css">

    <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/blog.css">
    <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/github.css">
        <link href="https://visibilityspots.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="visibilityspots Atom Feed" />
        <link href="https://visibilityspots.github.io/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="visibilityspots RSS Feed" />
        <script src="https://visibilityspots.github.io/blog/theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
    <a id="site-title" href="https://visibilityspots.github.io/blog"><h1>visibilityspots <i class="icon-dashboard"></i></h1></a>
        <p id="site-desc"> Linux & Open-Source enthusiast | Scouting | Longboarding </p>
    </hgroup>
    <form id="searchform" action="https://visibilityspots.github.io/blog/search.html" onsubmit="return (this.elements['q'].value.length > 0)">
	        <input id="searchbox" type="text" name="q" size="12" placeholder="search">
    </form>
    <nav>
        <ul id="nav-links">
                <li><a href="https://visibilityspots.github.io/blog/">Blog</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/profile.html">Profile</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/links.html">Links</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/projects.html">Projects</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/tools.html">Tools</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/contact.html">Contact</a></li>
        </ul>
    </nav>
    Categories:
      <ul>
	<li><a href="https://visibilityspots.github.io/blog/category/android.html">android</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/apple.html">apple</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/automation.html">automation</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/cloud.html">cloud</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/conferences.html">conferences</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/containers.html">containers</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/home-automation.html">home-automation</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/linux.html">linux</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/networking.html">networking</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/other.html">other</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/php.html">php</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/puppet.html">puppet</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/security.html">security</a></li>
      </ul>
<footer id="site-info">
  <a href="http://creativecommons.org/licenses/by-nc/2.0/be/deed.nl">License</a> | 2009 - 2021 <a href="https://visibilityspots.github.io/blog">visibilityspots.github.io/blog</a> | Generated by <a href="http://getpelican.com/" target="pelican">Pelican</a> | Hosted at <a href="https://pages.github.com/" target="github pages">github pages</a> | <a href="https://visibilityspots.github.io/blog/feeds/all.atom.xml" rel="alternate">Atom</a> feed
</footer></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2018-06-06T22:00:00+02:00" pubdate>
                            Wed 06 June 2018
                        </time>
                        <a href="https://visibilityspots.github.io/blog/prometheus-export-import.html" rel="bookmark"><h1>Prometheus export/import</h1></a>
                    </header>
                    <section class="post-content">
                        <p>bumping into the case where once deployed a full stack application we don't have any direct connection due to no uplink for security reasons.</p>
<p>So we (you too <a href="https://twitter.com/TomVanHumbeeck">@Tom</a>) looked into a way to export the prometheus data into a tar.gz which could be transferred and imported into an instance on our local machine.</p>
<p>After the initial blog post where we created a tar.gz file from the prometheus storage.tsdb.path on the filesystem <a href="https://twitter.com/roidelapluie">@roidelapluie</a> pointed me out about the <a href="https://prometheus.io/docs/prometheus/latest/querying/api/#snapshot">snapshot</a> feature.</p>
<p>So we did a bit of research and came up with this new procedure.</p>
<p>First of …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2018-06-04T22:00:00+02:00" pubdate>
                            Mon 04 June 2018
                        </time>
                        <a href="https://visibilityspots.github.io/blog/prometheus-consul.html" rel="bookmark"><h1>Prometheus consul service discovery</h1></a>
                    </header>
                    <section class="post-content">
                        <p>as published a few months ago I worked out a <a href="http://localhost:8000/jenkins-docker-pipeline.html">dockerized a jenkins farm</a> where both master as slaves are docker containers working together with services like nexus and such. Next to that setup I've dockerized my home setup where services like pi-hole, home-assistant and others are running as docker containers on a thin client I promoted to my home lab.</p>
<p>To have an overview about all those containers and the resources they are consuming I pulled in the git repo of <a href="https://github.com/vegasbrianc/prometheus">Brian Christner</a> which spins up a whole <a href="https://prometheus.io">prometheus</a> stack with some exporters and a grafana instance to visualize …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2018-04-21T21:00:00+02:00" pubdate>
                            Sat 21 April 2018
                        </time>
                        <a href="https://visibilityspots.github.io/blog/dockerized-cloudflared-pi-hole.html" rel="bookmark"><h1>dockerized DNS over HTTPS using pi-hole through cloudflared proxy-dns</h1></a>
                    </header>
                    <section class="post-content">
                        <p>a few months ago I configured a thin client as my home server to replace the previous <a href="../raspberry-pi.html">raspberry pi</a> setup.</p>
<p>During that migration I moved over all native services within docker containers. One of those services being a <a href="https://pi-hole.net">pi-hole</a> setup to block ad serving domains on dns level and to have a dns cache within our LAN to gain a bit of speed.</p>
<p>It has been running ever since without any issue and worked pretty well.</p>
<p>When cloudflare <a href="https://blog.cloudflare.com/announcing-1111/">announced</a> their fast and privacy based DNS resolver I got a bit intrigued by their DNS over HTTPS feature. Especially since our …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2018-02-15T21:00:00+01:00" pubdate>
                            Thu 15 February 2018
                        </time>
                        <a href="https://visibilityspots.github.io/blog/nrpe-troubleshooting.html" rel="bookmark"><h1>NRPE troubleshooting</h1></a>
                    </header>
                    <section class="post-content">
                        <p>When refactoring a <a href="https://github.com/visibilityspots/icinga-scripts/blob/master/check_memory">check_memory</a> I wrote a few years ago I bumped into the feared</p>
<div class="highlight"><pre><span></span><code><span class="n">NRPE</span><span class="o">:</span><span class="w"> </span><span class="n">Unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">output</span><span class="w"></span>
</code></pre></div>

<p>error message on our nagios instance.</p>
<p>When looking for a solution I went through most possible debug steps I could think of and which are nicely described by nagios <a href="https://support.nagios.com/kb/article/nrpe-nrpe-unable-to-read-output-620.html">support</a> but didn't found any solution.</p>
<p>I almost grabbed to some anti depressants when I thought of the thing I always forget about.</p>
<p><strong>SELINUX</strong></p>
<p>When crawling through the audit log it became clear I forgot to configure the proper selinux context type for the new script.</p>
<div class="highlight"><pre><span></span><code><span class="nv">type</span><span class="o">=</span><span class="nv">PATH</span> <span class="nv">msg</span><span class="o">=</span><span class="nv">audit …</span></code></pre></div>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-11-09T21:00:00+01:00" pubdate>
                            Thu 09 November 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/test-ansible-playbooks.html" rel="bookmark"><h1>Test ansible playbooks with docker</h1></a>
                    </header>
                    <section class="post-content">
                        <p>recently I started working at a new project where the infra is maintained by ansible. When been asked to write some functionality in a playbook I missed my <a href="https://github.com/visibilityspots/vagrant-puppet">vagrant puppet</a> setup where I could easily test my puppet code on my local machine.</p>
<p>Due to my previous project I felt like maybe I could use docker for this purpose on the ansible part. So I looked a bit around and stumbled on the <a href="https://github.com/William-Yeh/docker-ansible">docker-ansible github repository</a> of William Yeh. He already did a great job by creating a docker container with ansible preinstalled for a lot of linux distributions.</p>
<p>I …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-10-30T19:00:00+01:00" pubdate>
                            Mon 30 October 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/jenkins-docker-pipeline.html" rel="bookmark"><h1>Jenkins docker-pipeline</h1></a>
                    </header>
                    <section class="post-content">
                        <p>in a previous blog post I talked about setting up a <a href="https://visibilityspots.github.io/blog/dockerized-jenkins.html">dockerized jenkins master/slave setup</a> and setting up a <a href="https://visibilityspots.github.io/blog/nexus-oss-repository-manager.html">private docker registry using nexus</a>.</p>
<p>The next thing on the roadmap was to use this jenkins setup to actually build new docker images for specific software. Before going to the different teams and talking how they now build their software and how this could be done using this new containerized setup I setted up a new jenkins job.</p>
<p>This jenkins job will build a generic jenkins slave docker container which will be used by the jenkins master to build some …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-09-21T22:00:00+02:00" pubdate>
                            Thu 21 September 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/gradle-build.html" rel="bookmark"><h1>Jenkins gradle build succeeded with failure</h1></a>
                    </header>
                    <section class="post-content">
                        <p>Today we bumped into an interesting issue in the jenkins builds of some android based applications. The gradle commands succeeded but then suddenly failed the build with this most cryptic message ever:</p>
<div class="highlight"><pre><span></span><code><span class="n">BUILD</span><span class="w"> </span><span class="n">SUCCESSFUL</span><span class="w"></span>

<span class="n">Total</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">mins</span><span class="w"> </span><span class="mf">20.492</span><span class="w"> </span><span class="n">secs</span><span class="w"></span>

<span class="nl">FAILURE</span><span class="p">:</span><span class="w"> </span><span class="n">Build</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">exception</span><span class="p">.</span><span class="w"></span>

<span class="o">*</span><span class="w"> </span><span class="n">What</span><span class="w"> </span><span class="n">went</span><span class="w"> </span><span class="nl">wrong</span><span class="p">:</span><span class="w"></span>
<span class="n">Already</span><span class="w"> </span><span class="n">finished</span><span class="w"></span>

<span class="o">*</span><span class="w"> </span><span class="k">Try</span><span class="err">:</span><span class="w"></span>
<span class="n">Run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">stacktrace</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="n">trace</span><span class="p">.</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">info</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">debug</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="k">output</span><span class="p">.</span><span class="w"></span>
<span class="o">[</span><span class="n">Pipeline</span><span class="o">]</span><span class="w"> </span><span class="err">}</span><span class="w"></span>
</code></pre></div>

<p>Since this came out of nowhere without any modification on the build servers we where flabbergasted since the builds ran fine on our local machines.</p>
<p>So …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-09-11T19:00:00+02:00" pubdate>
                            Mon 11 September 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/nexus-oss-repository-manager.html" rel="bookmark"><h1>Nexus OSS repository manager</h1></a>
                    </header>
                    <section class="post-content">
                        <p>looking for a global repository store which could store maven projects, yum repositories, docker repositories, we bumped into <a href="https://help.sonatype.com/display/NXRM3/Repository+Manager+3">Nexus repository manager</a>. We used the official docker image to see how it can be implemented in the dockerized CI environment.</p>
<h2>docker repository</h2>
<p>as a first the docker repository feature could be enabled so we can start building and storing docker images for the different jenkins build slaves and the jenkins master so our work is reproducible and stored in a safe central place.</p>
<p>We configured 3 repositories in nexus for our docker images seen as a recommended approach in the <a href="https://help.sonatype.com/display/NXRM3/Private+Registry+for+Docker#PrivateRegistryforDocker-HostedRepositoryforDocker(PrivateRegistryforDocker)">nexus …</a></p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-09-06T22:00:00+02:00" pubdate>
                            Wed 06 September 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/dockerized-jenkins.html" rel="bookmark"><h1>Dockerized jenkins master/slave setup</h1></a>
                    </header>
                    <section class="post-content">
                        <p>started at a new customer we were looking for a more flexible way of having jenkins spinning up slaves on the fly. This in a way a slave is only started and consuming resources when a specific job is running. That way those resources could be used more efficient.</p>
<p>Also the fact that developers could take control over their build servers by managing the Dockerfiles themselves is a great advantage too. But that's for a later phase. Let's start at the beginning.</p>
<p>For the docker host a CentOS 7 server has been provisioned and prepared to run the docker daemon …</p>
                    </section>
                </article>
            </li>
            <hr/>
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2017-05-29T21:00:00+02:00" pubdate>
                            Mon 29 May 2017
                        </time>
                        <a href="https://visibilityspots.github.io/blog/docker-openstackclient-kilo.html" rel="bookmark"><h1>Docker openstackclient-kilo container</h1></a>
                    </header>
                    <section class="post-content">
                        <p>A couple of years ago I deployed an openstack cluster based on <a href="https://www.rdoproject.org/">RDO</a>. Back in the days we implemented the <a href="https://www.openstack.org/software/kilo/">kilo</a> release. Until today we didn't updated yet due to various reasons being no need for the new features, no resources, no time no.. Upgrading would be a better option but we'll have to live with it and since it's running rather well so far we are quite happy with it.</p>
<p>To manage that cloud I use the clients I installed on my local machine, from nova to cinder they all have different packages available for many different platforms. Only …</p>
                    </section>
                </article>
            </li>
            <hr/>
        </ol>
        <div class="paginator">
                    <a href="https://visibilityspots.github.io/blog/author/jan.html">
                        <i class="icon-circle-arrow-left"></i>
                    </a>
            Page 2 / 8
                <a href="https://visibilityspots.github.io/blog/author/jan3.html">
                    <i class="icon-circle-arrow-right"></i>
                </a>
        </div>

    </div>
        </div>

        <script src="https://visibilityspots.github.io/blog/theme/js/main.js"></script>
    </body>
</html>