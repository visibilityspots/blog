<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    Hubot, the github chat automated bot
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/normalize.css">
        <link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/main.css">
	<link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/tipuesearch/tipuesearch.css">

    <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/blog.css">
    <link rel="stylesheet" href="https://visibilityspots.github.io/blog/theme/css/github.css">
        <link href="https://visibilityspots.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="visibilityspots Atom Feed" />
        <link href="https://visibilityspots.github.io/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="visibilityspots RSS Feed" />
        <script src="https://visibilityspots.github.io/blog/theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
    <a id="site-title" href="https://visibilityspots.github.io/blog"><h1>visibilityspots <i class="icon-dashboard"></i></h1></a>
        <p id="site-desc"> Linux & Open-Source enthusiast | Scouting | Longboarding </p>
    </hgroup>
    <form id="searchform" action="https://visibilityspots.github.io/blog/search.html" onsubmit="return (this.elements['q'].value.length > 0)">
	        <input id="searchbox" type="text" name="q" size="12" placeholder="search">
    </form>
    <nav>
        <ul id="nav-links">
                <li><a href="https://visibilityspots.github.io/blog/">Blog</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/profile.html">Profile</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/links.html">Links</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/projects.html">Projects</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/tools.html">Tools</a></li>
                <li><a href="https://visibilityspots.github.io/blog/pages/contact.html">Contact</a></li>
        </ul>
    </nav>
    Categories:
      <ul>
	<li><a href="https://visibilityspots.github.io/blog/category/android.html">android</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/apple.html">apple</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/automation.html">automation</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/cloud.html">cloud</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/conferences.html">conferences</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/containers.html">containers</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/home-automation.html">home-automation</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/linux.html">linux</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/networking.html">networking</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/other.html">other</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/php.html">php</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/puppet.html">puppet</a></li>
	<li><a href="https://visibilityspots.github.io/blog/category/security.html">security</a></li>
      </ul>
<footer id="site-info">
  <a href="http://creativecommons.org/licenses/by-nc/2.0/be/deed.nl">License</a> | 2009 - 2021 <a href="https://visibilityspots.github.io/blog">visibilityspots.github.io/blog</a> | Generated by <a href="http://getpelican.com/" target="pelican">Pelican</a> | Hosted at <a href="https://pages.github.com/" target="github pages">github pages</a> | <a href="https://visibilityspots.github.io/blog/feeds/all.atom.xml" rel="alternate">Atom</a> feed
</footer></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <a href="https://visibilityspots.github.io/blog/hubot.html" rel="bookmark"><h1>Hubot, the github chat automated bot</h1></a>
<div><p>takes 1 minute to read</p></div>                        <time class="post-time" datetime="2013-06-03T19:00:00+02:00" pubdate>
                            last modified at Mon 03 June 2013
                        </time>
                    </header>
                    <section class="post-content">
                        <p>Some weeks ago I was asked by a customer to implement a bot on an IRC channel. Did some research about this topic and stumbled on the github <a class="reference external" href="http://github.hubot.com">hubot</a>.</p>
<p>The installation on a dedicated server running CentOS 6, using the irc adapter isn't hard. By following those steps you can easily start your own bot on a specified IRC channel.</p>
<p>You need some pre installed packages:</p>
<pre class="literal-block">
# yum install openssl openssl-devel openssl-static crypto-utils expat expat-devel gcc-c++ git
</pre>
<p>After installed those pre requirements nodejs is the next service we need. You can install the newest version using rpm packages you can find on the internet. For example on my <a class="reference external" href="http://repository.visibilityspots.com/repoview">repo</a> or building it from source:</p>
<pre class="literal-block">
$ wget http://nodejs.org/dist/v0.8.17/node-v0.8.17.tar.gz
$ tar xf node-v0.8.17.tar.gz -C /usr/local/src &amp;&amp; cd /usr/local/src/node-v0.8.17
$ ./configure &amp;&amp; make &amp;&amp; make install
</pre>
<p>As you can see in the output, npm is installed into the '/usr/local/bin/' directory. To get this working in bash you could add this directory into your $PATH environment</p>
<pre class="literal-block">
$ PATH=$PATH:/usr/local/bin/
</pre>
<p>So now we can use npm to install hubot and coffee-script:</p>
<pre class="literal-block">
$ npm install -g hubot coffee-script
</pre>
<p>You could now create your very own dedicated hubot by declaring the necessary files into your preferred path:</p>
<pre class="literal-block">
$ hubot -c /opt/hubot/
</pre>
<p>That way the core hubot you can use is installed in its own directory. We now have to install and configure the <a class="reference external" href="'https://github.com/github/hubot/wiki/Adapter:-IRC">irc-adapter</a>. Therefore you need to adapt the package.json file in your newly created hubot folder (/opt/hubot/) by inserting the hubot-irc dependency:</p>
<pre class="literal-block">
&quot;dependencies&quot;: {
  &quot;hubot-irc&quot;: &quot;&gt;= 0.0.1&quot;,
  &quot;hubot&quot;: &quot;&gt;= 2.0.0&quot;,
  ...
}
</pre>
<p>Once that's done you can install the dependencies by using npm:</p>
<pre class="literal-block">
$ npm install
</pre>
<p>Last thing you have to do is configure the needed irc parameters. This can be done by exporting the environment parameters. I decided to use a file to accomplish this. In the /opt/hubot/ directory I created a hubot.env file containing the necessary parameters:</p>
<pre class="literal-block">
# IRC adapter parameters
export HUBOT_IRC_NICK=&quot;NAMEOFYOURBOT&quot;
export HUBOT_IRC_ROOMS=&quot;#CHANNELONIRC&quot;
export HUBOT_IRC_SERVER=&quot;irc.freenode.net&quot;
export HUBOT_IRC_DEBUG=&quot;false&quot;
export HUBOT_IRC_UNFLOOD=&quot;false&quot;
export HUBOT_IRC_SERVER_FAKE_SSL&quot;false&quot;
export HUBOT_IRC_USESSL&quot;false&quot;
</pre>
<p>Most of those params are quite obvious, the unflood param configured to false prevented the hubot to crash when someone asked hubot: help ;)</p>
<p>After I tested this standard setup out I started to write a <a class="reference external" href="https://github.com/visibilityspots/puppet-hubot">puppet-hubot</a> module to automate those steps and configuration on a CentOS machine. Using a the <a class="reference external" href="https://github.com/visibilityspots/puppet-nodejs">puppet-nodejs</a> module which installs the <a class="reference external" href="http://nodejs.org">nodejs</a> rpm I packaged on my visibilityspots <a class="reference external" href="http://repository.visibilityspots.com/repoview">repo</a> the installation become easy peasy.</p>
<p>By using this puppet setup a hubot <a class="reference external" href="https://github.com/visibilityspots/scripts/blob/master/hubot">init</a> script is automatically deployed so a hubot init service can be used for starting, stopping, restarting and getting the status of the hubot service on your dedicated machine.</p>
<p>As you can see in the init script I use a hubot user to run the hubot. That way it's a bit more secure to run the hubot service on your server.</p>
<p>A 2nd script which is deployed using the puppet-hubot module is the <a class="reference external" href="https://github.com/visibilityspots/scripts/blob/master/hubot-plugin.sh">hubot-plugin.sh</a> script. By using this script you can automatically install a script from the hubot scripts <a class="reference external" href="http://hubot-script-catalog.herokuapp.com/">catalog</a>. If the author of the script uses the standard documentation rules the scripts will declare it self in your hubot-scripts.json file, declaring it's dependencies in the package.json file, if there are adding it's needed configuration parameters in plugins.env and restarting the hubot service.</p>
<p>If you notice a script which hasn't been documented the standard way, you can easily use pull requests, the author of the github hubot-scripts repository really takes it serious and merge those requests on a regular base.</p>
<p>Last but not least I also created a hubot instance using the <a class="reference external" href="https://github.com/markstory/hubot-xmpp">xmpp-adapter</a>. After some desperate debugging and failing I figured out that for the irc adapter it doesn't matter which nodejs version you installed. For the xmpp adapter on the other hand it only worked by installing nodejs v0.8.17 build from the sources and by never ever use npm update but npm install instead to install the npm dependencies.</p>
<p>It saves you a lot of time if you take that tip in memory :)</p>
<p>Enjoy using your hubot</p>

                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="https://visibilityspots.github.io/blog/category/linux.html">linux</a></p>
                        <p>Tags: <a href="https://visibilityspots.github.io/blog/tag/hubot.html">hubot</a>, <a href="https://visibilityspots.github.io/blog/tag/irc.html">irc</a>, <a href="https://visibilityspots.github.io/blog/tag/xmpp.html">xmpp</a>, <a href="https://visibilityspots.github.io/blog/tag/chat.html">chat</a>, <a href="https://visibilityspots.github.io/blog/tag/bot.html">bot</a>, <a href="https://visibilityspots.github.io/blog/tag/github.html">github</a>, <a href="https://visibilityspots.github.io/blog/tag/scripts.html">scripts</a>, </p>
                    </aside>
                    <hr/>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'visibilityspots';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
                </article>
            </li>
        </ol>
    </div>
        </div>

        <script src="https://visibilityspots.github.io/blog/theme/js/main.js"></script>
    </body>
</html>